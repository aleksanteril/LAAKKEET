<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="1092px" preserveAspectRatio="none" style="width:1622px;height:1092px;background:#FFFFFF;" version="1.1" viewBox="0 0 1622 1092" width="1622px" zoomAndPan="magnify"><defs/><g><g id="STANDBY"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="330.1484" x="465.88" y="168.67"/><line style="stroke:#181818;stroke-width:0.5;" x1="465.88" x2="796.0284" y1="194.9669" y2="194.9669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.4248" x="597.7418" y="186.6651">STANDBY</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229.5762" x="470.88" y="211.1055">eEnter / reset_machine(m), timer = 0;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="223.8457" x="470.88" y="225.0743">eTick [timer % 20 = 0] / led_toggle();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="310.1484" x="470.88" y="239.043">eTick [timer&gt;=600] / send_msg(EMPTY), timer = 0;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="470.88" y="253.0118">eExit / led_off();</text></g><g id="RECALIBRATE"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="155.5977" x="1063.15" y="9.73"/><line style="stroke:#181818;stroke-width:0.5;" x1="1063.15" x2="1218.7477" y1="36.0269" y2="36.0269"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1611" x="1092.8683" y="27.7251">RECALIBRATE</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="135.5977" x="1068.15" y="52.1655">eEnter / re_calibrate();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="1068.15" y="66.1343">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="1068.15" y="80.103">eExit /</text></g><g class="entity" data-entity="N1" data-source-line="16" data-uid="ent0004" id="entity_N1"><path d="M1258.76,6 L1258.76,91.6641 L1615.1384,91.6641 L1615.1384,16 L1605.1384,6 L1258.76,6" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1605.1384,6 L1605.1384,16 L1615.1384,16 L1605.1384,6" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.9438" x="1268.8923" y="23.0669">- struct Machine, jossa pill_count,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.7104" x="1268.8923" y="38.1997">sun muut yleiset tiedot stateille.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.3687" x="1268.8923" y="53.3325">- Olkoon 1 tick aluksi 50ms.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.1099" x="1268.8923" y="68.4653">- send_msg() on viestin l&#228;hetys LoRa verkkoon</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.2461" x="1268.8923" y="83.5981">- EEPROM Tallennus tapahtuu aina kun tila vaihtuu</text></g><g id="CHECK_CALIBRATION"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="169.4678" x="392.22" y="341.57"/><line style="stroke:#181818;stroke-width:0.5;" x1="392.22" x2="561.6878" y1="367.8669" y2="367.8669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.4678" x="402.22" y="359.5651">CHECK_CALIBRATION</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="117.2813" x="397.22" y="384.0055">eEnter / calibrate();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="397.22" y="397.9743">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="397.22" y="411.943">eExit /</text></g><g id="CALIBRATED"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="277.332" x="338.29" y="500.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="338.29" x2="615.622" y1="526.7969" y2="526.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.3682" x="432.7719" y="518.4951">CALIBRATED</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="257.332" x="343.29" y="542.9355">eEnter / led_on(); send_msg(CALIBRATED);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="343.29" y="556.9043">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="343.29" y="570.873">eExit / led_off();</text></g><g id="DISPENSE_WAIT"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="291.3887" x="427.26" y="655.7"/><line style="stroke:#181818;stroke-width:0.5;" x1="427.26" x2="718.6487" y1="681.9969" y2="681.9969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.3896" x="516.7595" y="673.6951">DISPENSE_WAIT</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="194.4258" x="432.26" y="698.1355">eEnter / make_timeout_stamp();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="271.3887" x="432.26" y="712.1043">eEnter [RETRY TWICE!] / send_msg(STATUS);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="432.26" y="726.073">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="432.26" y="740.0418">eExit /</text></g><g id="DISPENSE_PILL"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="203.1055" x="892.4" y="824.88"/><line style="stroke:#181818;stroke-width:0.5;" x1="892.4" x2="1095.5055" y1="851.1769" y2="851.1769"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.46" x="941.7228" y="842.8751">DISPENSE_PILL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="183.1055" x="897.4" y="867.3155">eEnter / timer = 0, dispense();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140.1211" x="897.4" y="881.2843">eEnter / ++turn_count;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.4629" x="897.4" y="895.253">eTick / ++timer;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="897.4" y="909.2218">eExit /</text></g><g id="DISPENSE_FAIL"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="269.2754" x="441.31" y="994.05"/><line style="stroke:#181818;stroke-width:0.5;" x1="441.31" x2="710.5854" y1="1020.3469" y2="1020.3469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.8477" x="523.0239" y="1012.0451">DISPENSE_FAIL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249.2754" x="446.31" y="1036.4855">eEnter / timer = 0; send_msg(DISP_FAIL);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.4629" x="446.31" y="1050.4543">eTick / ++timer;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="223.8457" x="446.31" y="1064.423">eTick [timer % 20 = 0] / led_toggle();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="446.31" y="1078.3918">eExit / led_off();</text></g><ellipse cx="630.95" cy="48.83" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><g class="entity" data-entity="GMN2" data-source-line="17" data-uid="ent0003" id="entity_GMN2"><path d="M175.76,187.05 L175.76,242.4484 A0,0 0 0 0 175.76,242.4484 L426.1516,242.4484 A0,0 0 0 0 426.1516,242.4484 L426.1516,218.75 L465.74,214.75 L426.1516,210.75 L426.1516,197.05 L416.1516,187.05 L175.76,187.05 A0,0 0 0 0 175.76,187.05" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M416.1516,187.05 L416.1516,197.05 L426.1516,197.05 L416.1516,187.05" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.3491" x="181.76" y="204.1169">When the dispenser is started</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.127" x="185.8923" y="219.2497">it waits for a button to be pressed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.4438" x="185.8923" y="234.3825">and blinks an LED while waiting.</text></g><g class="entity" data-entity="GMN5" data-source-line="25" data-uid="ent0006" id="entity_GMN5"><path d="M6,337.84 L6,423.5041 A0,0 0 0 0 6,423.5041 L351.9048,423.5041 A0,0 0 0 0 351.9048,423.5041 L351.9048,384.67 L391.81,380.67 L351.9048,376.67 L351.9048,347.84 L341.9048,337.84 L6,337.84 A0,0 0 0 0 6,337.84" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M341.9048,337.84 L341.9048,347.84 L351.9048,347.84 L341.9048,337.84" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.689" x="12" y="354.9069">When the button is pressed the dispenser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.0767" x="16.1323" y="370.0397">is calibrated by turning the wheel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0488" x="16.1323" y="385.1725">at least one full turn and then stopping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.0723" x="16.1323" y="400.3053">the wheel so that the compartment with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.7725" x="16.1323" y="415.4381">the sensor opening is aligned with the drop tube.</text></g><g class="entity" data-entity="GMN8" data-source-line="32" data-uid="ent0009" id="entity_GMN8"><path d="M760.97,519.47 L760.97,535.6 L616.01,539.6 L760.97,543.6 L760.97,559.7356 A0,0 0 0 0 760.97,559.7356 L1082.9378,559.7356 A0,0 0 0 0 1082.9378,559.7356 L1082.9378,529.47 L1072.9378,519.47 L760.97,519.47 A0,0 0 0 0 760.97,519.47" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1072.9378,519.47 L1072.9378,529.47 L1082.9378,529.47 L1072.9378,519.47" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.9019" x="766.97" y="536.5369">After calibration the program keeps</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296.8354" x="771.1023" y="551.6697">the LED on until user presses another button.</text></g><g class="entity" data-entity="GMN11" data-source-line="41" data-uid="ent0012" id="entity_GMN11"><path d="M82.95,681.66 L82.95,721.9256 A0,0 0 0 0 82.95,721.9256 L386.9603,721.9256 A0,0 0 0 0 386.9603,721.9256 L386.9603,705.79 L426.94,701.79 L386.9603,697.79 L386.9603,691.66 L376.9603,681.66 L82.95,681.66 A0,0 0 0 0 82.95,681.66" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M376.9603,681.66 L376.9603,691.66 L386.9603,691.66 L376.9603,681.66" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9136" x="88.95" y="698.7269">Then it dispenses pills every</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.8779" x="93.0823" y="713.8597">30 seconds starting from the button press.</text></g><g class="entity" data-entity="GMN14" data-source-line="42" data-uid="ent0015" id="entity_GMN14"><path d="M758.6,674.09 L758.6,697.79 L719.06,701.79 L758.6,705.79 L758.6,729.4884 A0,0 0 0 0 758.6,729.4884 L1013.308,729.4884 A0,0 0 0 0 1013.308,729.4884 L1013.308,684.09 L1003.308,674.09 L758.6,674.09 A0,0 0 0 0 758.6,674.09" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1003.308,674.09 L1003.308,684.09 L1013.308,684.09 L1003.308,674.09" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.5757" x="764.6" y="691.1569">When all pills have been dispensed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.605" x="768.7323" y="706.2897">(wheel turned 7 times)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.6816" x="768.7323" y="721.4225">the program starts over.</text></g><g class="entity" data-entity="GMN17" data-source-line="51" data-uid="ent0018" id="entity_GMN17"><path d="M603.25,843.26 L603.25,898.6584 A0,0 0 0 0 603.25,898.6584 L852.6514,898.6584 A0,0 0 0 0 852.6514,898.6584 L852.6514,874.96 L892.02,870.96 L852.6514,866.96 L852.6514,853.26 L842.6514,843.26 L603.25,843.26 A0,0 0 0 0 603.25,843.26" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M842.6514,843.26 L842.6514,853.26 L852.6514,853.26 L842.6514,843.26" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3613" x="609.25" y="860.3269">When the wheel is turned,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.1367" x="613.3823" y="875.4597">the piezo sensor is used to detect</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.2773" x="613.3823" y="890.5925">if a pill was dispensed or not.</text></g><g class="entity" data-entity="GMN20" data-source-line="59" data-uid="ent0021" id="entity_GMN20"><path d="M24.46,1027.57 L24.46,1052.7028 A0,0 0 0 0 24.46,1052.7028 L401.4429,1052.7028 A0,0 0 0 0 401.4429,1052.7028 L401.4429,1045.57 L440.99,1040.13 L401.4429,1037.57 L401.4429,1037.57 L391.4429,1027.57 L24.46,1027.57 A0,0 0 0 0 24.46,1027.57" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M391.4429,1027.57 L391.4429,1037.57 L401.4429,1037.57 L391.4429,1027.57" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.9829" x="30.46" y="1044.6369">If no pill was detected (200ms) the LED blinks 5 times.</text></g><!--link *start* to STANDBY--><g class="link" data-entity-1=".start." data-entity-2="STANDBY" data-source-line="1" data-uid="lnk3" id="link_.start._STANDBY"><path d="M630.95,59.12 C630.95,79.77 630.95,124.69 630.95,162.49" fill="none" id="*start*-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="630.95,168.49,634.95,159.49,630.95,163.49,626.95,159.49,630.95,168.49" style="stroke:#181818;stroke-width:1;"/></g><!--link STANDBY to CHECK_CALIBRATION--><g class="link" data-entity-1="STANDBY" data-entity-2="CHECK_CALIBRATION" data-source-line="6" data-uid="lnk4" id="link_STANDBY_CHECK_CALIBRATION"><path d="M612.79,261.2 C605.09,277.04 595.07,294.24 582.95,307.84 C571.93,320.2 563.2425,327.9768 549.5225,337.7168" fill="none" id="STANDBY-to-CHECK_CALIBRATION" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="544.63,341.19,554.2842,339.2418,548.7071,338.2956,549.6533,332.7185,544.63,341.19" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.8872" x="596.95" y="303.9069">eSW0 /</text></g><!--link CHECK_CALIBRATION to STANDBY--><g class="link" data-entity-1="CHECK_CALIBRATION" data-entity-2="STANDBY" data-source-line="22" data-uid="lnk8" id="link_CHECK_CALIBRATION_STANDBY"><path d="M413.83,341.16 C396.92,326 386.4,308.1 398.95,290.84 C408.76,277.36 428.8018,267.0086 459.7318,256.4486" fill="none" id="CHECK_CALIBRATION-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="465.41,254.51,455.6003,253.6325,460.6782,256.1255,458.1851,261.2034,465.41,254.51" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.3452" x="399.95" y="303.9069">eTick [calibrated = false] /</text></g><!--link *start* to RECALIBRATE--><g class="link" data-entity-1=".start." data-entity-2="RECALIBRATE" data-source-line="8" data-uid="lnk5" id="link_.start._RECALIBRATE"><path d="M641.14,48.83 C693.61,48.83 929.81,48.83 1056.78,48.83" fill="none" id="*start*-to-RECALIBRATE" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1062.78,48.83,1053.78,44.83,1057.78,48.83,1053.78,52.83,1062.78,48.83" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381.6846" x="661.55" y="26.8969">[If state loaded from EEPROM on boot was DISPENSE_PILL]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.728" x="772.0944" y="42.0297">/ Recalibrate the spinner.</text></g><!--link RECALIBRATE to STANDBY--><g class="link" data-entity-1="RECALIBRATE" data-entity-2="STANDBY" data-source-line="12" data-uid="lnk6" id="link_RECALIBRATE_STANDBY"><path d="M1062.86,56.23 C986.42,64.51 867.81,82.78 771.95,121.67 C743.1,133.37 718.7753,147.8434 694.4553,164.7634" fill="none" id="RECALIBRATE-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="689.53,168.19,699.2023,166.3336,693.6344,165.3345,694.6335,159.7666,689.53,168.19" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.1553" x="772.95" y="134.7369">eEnter [calibrated = false] / send_msg(RECAL FAIL);</text></g><!--link RECALIBRATE to DISPENSE_PILL--><g class="link" data-entity-1="RECALIBRATE" data-entity-2="DISPENSE_PILL" data-source-line="13" data-uid="lnk7" id="link_RECALIBRATE_DISPENSE_PILL"><path d="M1142.05,88.25 C1142.91,121.47 1143.95,170.77 1143.95,213.75 C1143.95,213.75 1143.95,213.75 1143.95,702.79 C1143.95,745.7 1141.27,760.99 1114.95,794.88 C1106.31,806.01 1100.322,812.3027 1088.762,820.9627" fill="none" id="RECALIBRATE-to-DISPENSE_PILL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1083.96,824.56,1093.5612,822.3653,1087.9617,821.5622,1088.7648,815.9627,1083.96,824.56" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.0669" x="1144.95" y="466.5669">eTick / recall_position();</text></g><!--link CHECK_CALIBRATION to CALIBRATED--><g class="link" data-entity-1="CHECK_CALIBRATION" data-entity-2="CALIBRATED" data-source-line="23" data-uid="lnk9" id="link_CHECK_CALIBRATION_CALIBRATED"><path d="M476.95,420.06 C476.95,444.38 476.95,469.72 476.95,494.06" fill="none" id="CHECK_CALIBRATION-to-CALIBRATED" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="476.95,500.06,480.95,491.06,476.95,495.06,472.95,491.06,476.95,500.06" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0986" x="477.95" y="466.5669">eTick [calibrated = true] /</text></g><!--link CALIBRATED to DISPENSE_WAIT--><g class="link" data-entity-1="CALIBRATED" data-entity-2="DISPENSE_WAIT" data-source-line="30" data-uid="lnk10" id="link_CALIBRATED_DISPENSE_WAIT"><path d="M460.64,579.13 C456.69,594.35 455.47,611.54 462.95,625.7 C468.89,636.95 472.8802,642.8386 482.5102,651.4186" fill="none" id="CALIBRATED-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="486.99,655.41,482.9312,646.4364,483.2568,652.0839,477.6093,652.4095,486.99,655.41" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.1089" x="463.95" y="621.7669">eSW1 / send_msg(DISP_START)</text></g><!--link DISPENSE_WAIT to DISPENSE_PILL--><g class="link" data-entity-1="DISPENSE_WAIT" data-entity-2="DISPENSE_PILL" data-source-line="38" data-uid="lnk11" id="link_DISPENSE_WAIT_DISPENSE_PILL"><path d="M719.11,742.64 C725.81,744.42 732.45,746.17 738.95,747.88 C791.72,761.69 808.17,755.58 857.95,777.88 C885.28,790.11 908.1875,804.3128 931.4575,820.9328" fill="none" id="DISPENSE_WAIT-to-DISPENSE_PILL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="936.34,824.42,931.341,815.9341,932.2712,821.514,926.6914,822.4442,936.34,824.42" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.8682" x="889.95" y="790.9469">eTick [time_reached(TIMEOUT)] /</text></g><!--link DISPENSE_PILL to DISPENSE_WAIT--><g class="link" data-entity-1="DISPENSE_PILL" data-entity-2="DISPENSE_WAIT" data-source-line="48" data-uid="lnk13" id="link_DISPENSE_PILL_DISPENSE_WAIT"><path d="M892.2,829.93 C885.74,828.05 879.29,826.34 872.95,824.88 C805.73,809.37 610.32,845.96 563.95,794.88 C552.62,782.39 550.9085,770.5325 554.2385,753.9525" fill="none" id="DISPENSE_PILL-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="555.42,748.07,549.7261,756.1061,554.4354,752.9721,557.5695,757.6814,555.42,748.07" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.5977" x="564.95" y="790.9469">ePiezo / ++pill_count; send_msg(DISP_OK);</text></g><!--link DISPENSE_WAIT to STANDBY--><g class="link" data-entity-1="DISPENSE_WAIT" data-entity-2="STANDBY" data-source-line="39" data-uid="lnk12" id="link_DISPENSE_WAIT_STANDBY"><path d="M651.78,655.49 C661.1,646.82 669.3,636.89 674.95,625.7 C735.83,505.29 685.4562,345.4997 653.4662,266.6697" fill="none" id="DISPENSE_WAIT-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="651.21,261.11,650.8878,270.9536,653.0901,265.743,658.3007,267.9454,651.21,261.11" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293.522" x="702.95" y="466.5669">eEnter [pill_count &gt;= 7] / send_msg(EMPTY);</text></g><!--link DISPENSE_PILL to DISPENSE_FAIL--><g class="link" data-entity-1="DISPENSE_PILL" data-entity-2="DISPENSE_FAIL" data-source-line="49" data-uid="lnk14" id="link_DISPENSE_PILL_DISPENSE_FAIL"><path d="M891.97,912.75 C830.82,937.2 758.511,966.1221 695.371,991.3721" fill="none" id="DISPENSE_PILL-to-DISPENSE_FAIL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="689.8,993.6,699.6418,993.9722,694.4425,991.7434,696.6713,986.5441,689.8,993.6" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0508" x="797.95" y="960.1169">eTick [timer &gt;= 4] /</text></g><!--link DISPENSE_FAIL to DISPENSE_WAIT--><g class="link" data-entity-1="DISPENSE_FAIL" data-entity-2="DISPENSE_WAIT" data-source-line="57" data-uid="lnk15" id="link_DISPENSE_FAIL_DISPENSE_WAIT"><path d="M501.03,993.81 C475.09,973.82 449.01,947.83 434.95,917.05 C417.93,879.79 418.13,862.23 434.95,824.88 C448.75,794.25 469.7236,771.9188 495.2336,751.8588" fill="none" id="DISPENSE_FAIL-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="499.95,748.15,490.4028,750.5689,496.0196,751.2407,495.3479,756.8575,499.95,748.15" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.5928" x="435.95" y="875.5269">eTick [timer &gt;= 200] /</text></g><!--SRC=[TLRRRkCs47ttLqmNA61t4yVPThj0WmJm9YhMM2SsR2s2m0a4sXfPh2LI4AcawVVqJ_fZ7L8Nw-QdE9ehppapvEQN5pW_lu6rEtsu-_eqAFx27u2Eq9Z21QIeK7insuLSu30UdO7cCLckON9LztVvxW2RtFOpV9eOXnUAZz3tjDpl8noEhk14nCtrxnFhhL3uNgpsG-T-wJwTBERypNMHMmO19QwCvZIttvpRxzxjT3xxkfgwiyM32La_Jk1YCDYO4z_0oYdD3Xatim2KPXeXain77u9Knk0uozNY7gI0hPGQtfY2kzbwwJoi7MyvcyzVdWNriC8TY_WsDT4wH5095mBJyQ1PeeQdLmMOnbjk5fIBJh0zR-DhZRPZ-asLsYVC0XOfRA1g4y2VqzcyLTbaQnpks0jrJ5aZBv6AQow5QNem49BE-m7E2RSqsscupmLo1dz9fHWad29sCXFw30WcbGc8iqp3UuISz4Iqea-OMj395SV6wnmMqK4ItfTafz8ioWwAm-T9hCRMN9rZP5XvvQWq5n3zzs-8-bt1NAuOl69wC4biG46XI_sZ49a2pH8MwYm3nWM30xMbUKH1Z9kl7u0uVhZC3nTXe446DP0VGnIMOv-h18KYmBaoPqWDtbIG6vLmhI2GAJ3OPbfJdrh25Y6XGLAv6nC-R2Ck3ef-mjovWxUGHsXZkTYF1uDU1PSAQiYdrxCWxaIQN4jTMqjH-NZs2kf4S2MdknFn91KRtWIuhyiAwW93mha4i4d0ixNLgcpVGMUf81ojvrk865dGDHLaYYeAX22B8kjckT2ccD8oIKpKiwW5Aad_KAZvifDnGbJ7A8XchiFIarIfY6z97PbuQeUwsGlgnNhPVbEPKBqj6cuRA9MasbLcPkieygEZuRcBxKKxLMSfrkoD0N-Spjny9rxMjuEnUwI0bJjgKrGlD0rCooNaNEOe9AdSfoo60sAYIcYCjibEQu17a1c-SXQDy2Kvf0M_14kdkHAPc1tGCzU0pBH7mnOdzY8vuRzPEUxg2Tp7sQtpKsFtqS7S7sj2fHDPZaitPOveot1wLzhBp4kHTY7wGtTsxon-k2EZ-6w6xku-xaoukOOlFTVXLOkMTiEk4JArN8w7idjO0T9IV3US_3gXb3if_69j6RtQkwusQfQXSLuevVkmjvATJzggHO6GlL8yqhUoj5rqmto8pA3HXo_sCbUZKXobOcmd2kIhkJK77MHB7LGlWREgoB3EPjl_uqTJDmUqnwqWdRnCthuy-PviVkyTeoN7VwJDTQJmgZLMY- -TNXkvp9tSVaQH2dxhhijsezMgpC6czPFZVLRXRDihjXIPCxj59VYeaMvkiq43oAzi-yWvKaZ-LBfEIjbcXvJsUOitHl_v-c3l0-3aExAdeSxoQxhq4jS2-vDzWvw2kwX4JqKXQs1P40ch8KN79EvoxHKN_ETSzEF_0G00]--></g></svg>