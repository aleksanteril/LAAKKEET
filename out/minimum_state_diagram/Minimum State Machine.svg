<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="1142px" preserveAspectRatio="none" style="width:1468px;height:1142px;background:#FFFFFF;" version="1.1" viewBox="0 0 1468 1142" width="1468px" zoomAndPan="magnify"><defs/><g><g id="STANDBY"><rect fill="#F1F1F1" height="106.1406" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="330.1484" x="296.12" y="176.17"/><line style="stroke:#181818;stroke-width:0.5;" x1="296.12" x2="626.2684" y1="202.4669" y2="202.4669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.4248" x="427.9818" y="194.1651">STANDBY</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229.5762" x="301.12" y="218.6055">eEnter / reset_machine(m), timer = 0;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="223.8457" x="301.12" y="232.5743">eTick [timer % 20 = 0] / led_toggle();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="310.1484" x="301.12" y="246.543">eTick [timer&gt;=600] / send_msg(EMPTY), timer = 0;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="301.12" y="260.5118">eExit / led_off();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="117.1758" x="301.12" y="274.4805">eSW1 / erase_log();</text></g><g id="RECALIBRATE"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="171.1367" x="893.63" y="7"/><line style="stroke:#181818;stroke-width:0.5;" x1="893.63" x2="1064.7667" y1="33.2969" y2="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1611" x="931.1178" y="24.9951">RECALIBRATE</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="135.5977" x="898.63" y="49.4355">eEnter / re_calibrate();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151.1367" x="898.63" y="63.4043">eEnter / recall_position();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="898.63" y="77.373">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="898.63" y="91.3418">eExit /</text></g><g class="entity" data-entity="N1" data-source-line="18" data-uid="ent0004" id="entity_N1"><path d="M1105.01,10.25 L1105.01,95.9141 L1461.3884,95.9141 L1461.3884,20.25 L1451.3884,10.25 L1105.01,10.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1451.3884,10.25 L1451.3884,20.25 L1461.3884,20.25 L1451.3884,10.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.9438" x="1115.1423" y="27.3169">- struct Machine, jossa pill_count,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.7104" x="1115.1423" y="42.4497">sun muut yleiset tiedot stateille.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.3687" x="1115.1423" y="57.5825">- Olkoon 1 tick aluksi 50ms.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.1099" x="1115.1423" y="72.7153">- send_msg() on viestin l&#228;hetys LoRa verkkoon</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.2461" x="1115.1423" y="87.8481">- EEPROM Tallennus tapahtuu aina kun tila vaihtuu</text></g><g id="CHECK_CALIBRATION"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="169.4678" x="697.46" y="363.04"/><line style="stroke:#181818;stroke-width:0.5;" x1="697.46" x2="866.9278" y1="389.3369" y2="389.3369"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.4678" x="707.46" y="381.0351">CHECK_CALIBRATION</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="117.2813" x="702.46" y="405.4755">eEnter / calibrate();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="702.46" y="419.4443">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="702.46" y="433.413">eExit /</text></g><g id="CALIBRATED"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="277.332" x="651.53" y="521.97"/><line style="stroke:#181818;stroke-width:0.5;" x1="651.53" x2="928.862" y1="548.2669" y2="548.2669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.3682" x="746.0119" y="539.9651">CALIBRATED</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="257.332" x="656.53" y="564.4055">eEnter / led_on(); send_msg(CALIBRATED);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="656.53" y="578.3743">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="656.53" y="592.343">eExit / led_off();</text></g><g id="DISPENSE_WAIT"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="291.3887" x="350.5" y="692.18"/><line style="stroke:#181818;stroke-width:0.5;" x1="350.5" x2="641.8887" y1="718.4769" y2="718.4769"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.3896" x="439.9995" y="710.1751">DISPENSE_WAIT</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="194.4258" x="355.5" y="734.6155">eEnter / make_timeout_stamp();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="271.3887" x="355.5" y="748.5843">eEnter [RETRY TWICE!] / send_msg(STATUS);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="355.5" y="762.553">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="355.5" y="776.5218">eExit /</text></g><g id="DISPENSE_PILL"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="203.1055" x="609.64" y="861.35"/><line style="stroke:#181818;stroke-width:0.5;" x1="609.64" x2="812.7455" y1="887.6469" y2="887.6469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.46" x="658.9628" y="879.3451">DISPENSE_PILL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="183.1055" x="614.64" y="903.7855">eEnter / timer = 0, dispense();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140.1211" x="614.64" y="917.7543">eEnter / ++turn_count;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.4629" x="614.64" y="931.723">eTick / ++timer;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="614.64" y="945.6918">eExit /</text></g><g id="DISPENSE_OK"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="196.0332" x="114.18" y="1044.49"/><line style="stroke:#181818;stroke-width:0.5;" x1="114.18" x2="310.2132" y1="1070.7869" y2="1070.7869"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.4893" x="163.952" y="1062.4851">DISPENSE_OK</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="176.0332" x="119.18" y="1086.9255">eEnter / send_msg(DISP_OK);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="119.18" y="1100.8943">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="160.5938" x="119.18" y="1114.863">eExit / write_log(DISP_OK);</text></g><g id="DISPENSE_FAIL"><rect fill="#F1F1F1" height="106.1406" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="269.2754" x="767.56" y="1030.52"/><line style="stroke:#181818;stroke-width:0.5;" x1="767.56" x2="1036.8354" y1="1056.8169" y2="1056.8169"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.8477" x="849.2739" y="1048.5151">DISPENSE_FAIL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249.2754" x="772.56" y="1072.9555">eEnter / timer = 0; send_msg(DISP_FAIL);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.4629" x="772.56" y="1086.9243">eTick / ++timer;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="223.8457" x="772.56" y="1100.893">eTick [timer % 20 = 0] / led_toggle();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="772.56" y="1114.8618">eExit / led_off();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="168.6152" x="772.56" y="1128.8305">eExit / write_log(DISP_FAIL);</text></g><ellipse cx="461.2" cy="53.08" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><g class="entity" data-entity="GMN2" data-source-line="19" data-uid="ent0003" id="entity_GMN2"><path d="M6,201.54 L6,256.9384 A0,0 0 0 0 6,256.9384 L256.3916,256.9384 A0,0 0 0 0 256.3916,256.9384 L256.3916,233.24 L295.99,229.24 L256.3916,225.24 L256.3916,211.54 L246.3916,201.54 L6,201.54 A0,0 0 0 0 6,201.54" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M246.3916,201.54 L246.3916,211.54 L256.3916,211.54 L246.3916,201.54" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.3491" x="12" y="218.6069">When the dispenser is started</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.127" x="16.1323" y="233.7397">it waits for a button to be pressed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.4438" x="16.1323" y="248.8725">and blinks an LED while waiting.</text></g><g class="entity" data-entity="GMN5" data-source-line="27" data-uid="ent0006" id="entity_GMN5"><path d="M311.24,359.31 L311.24,444.9741 A0,0 0 0 0 311.24,444.9741 L657.1448,444.9741 A0,0 0 0 0 657.1448,444.9741 L657.1448,406.14 L697.05,402.14 L657.1448,398.14 L657.1448,369.31 L647.1448,359.31 L311.24,359.31 A0,0 0 0 0 311.24,359.31" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M647.1448,359.31 L647.1448,369.31 L657.1448,369.31 L647.1448,359.31" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.689" x="317.24" y="376.3769">When the button is pressed the dispenser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.0767" x="321.3723" y="391.5097">is calibrated by turning the wheel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0488" x="321.3723" y="406.6425">at least one full turn and then stopping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.0723" x="321.3723" y="421.7753">the wheel so that the compartment with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.7725" x="321.3723" y="436.9081">the sensor opening is aligned with the drop tube.</text></g><g class="entity" data-entity="GMN8" data-source-line="34" data-uid="ent0009" id="entity_GMN8"><path d="M289.21,540.94 L289.21,581.2056 A0,0 0 0 0 289.21,581.2056 L611.1778,581.2056 A0,0 0 0 0 611.1778,581.2056 L611.1778,565.07 L651.34,561.07 L611.1778,557.07 L611.1778,550.94 L601.1778,540.94 L289.21,540.94 A0,0 0 0 0 289.21,540.94" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M601.1778,540.94 L601.1778,550.94 L611.1778,550.94 L601.1778,540.94" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.9019" x="295.21" y="558.0069">After calibration the program keeps</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296.8354" x="299.3423" y="573.1397">the LED on until user presses another button.</text></g><g class="entity" data-entity="GMN11" data-source-line="43" data-uid="ent0012" id="entity_GMN11"><path d="M6.19,718.13 L6.19,758.3956 A0,0 0 0 0 6.19,758.3956 L310.2003,758.3956 A0,0 0 0 0 310.2003,758.3956 L310.2003,742.26 L350.18,738.26 L310.2003,734.26 L310.2003,728.13 L300.2003,718.13 L6.19,718.13 A0,0 0 0 0 6.19,718.13" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M300.2003,718.13 L300.2003,728.13 L310.2003,728.13 L300.2003,718.13" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9136" x="12.19" y="735.1969">Then it dispenses pills every</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.8779" x="16.3223" y="750.3297">30 seconds starting from the button press.</text></g><g class="entity" data-entity="GMN14" data-source-line="44" data-uid="ent0015" id="entity_GMN14"><path d="M681.84,710.56 L681.84,734.26 L642.3,738.26 L681.84,742.26 L681.84,765.9584 A0,0 0 0 0 681.84,765.9584 L936.548,765.9584 A0,0 0 0 0 936.548,765.9584 L936.548,720.56 L926.548,710.56 L681.84,710.56 A0,0 0 0 0 681.84,710.56" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M926.548,710.56 L926.548,720.56 L936.548,720.56 L926.548,710.56" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.5757" x="687.84" y="727.6269">When all pills have been dispensed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.605" x="691.9723" y="742.7597">(wheel turned 7 times)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.6816" x="691.9723" y="757.8925">the program starts over.</text></g><g class="entity" data-entity="GMN17" data-source-line="58" data-uid="ent0018" id="entity_GMN17"><path d="M320.5,879.73 L320.5,935.1284 A0,0 0 0 0 320.5,935.1284 L569.9014,935.1284 A0,0 0 0 0 569.9014,935.1284 L569.9014,911.43 L609.26,907.43 L569.9014,903.43 L569.9014,889.73 L559.9014,879.73 L320.5,879.73 A0,0 0 0 0 320.5,879.73" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M559.9014,879.73 L559.9014,889.73 L569.9014,889.73 L559.9014,879.73" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3613" x="326.5" y="896.7969">When the wheel is turned,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.1367" x="330.6323" y="911.9297">the piezo sensor is used to detect</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.2773" x="330.6323" y="927.0625">if a pill was dispensed or not.</text></g><g class="entity" data-entity="GMN20" data-source-line="67" data-uid="ent0021" id="entity_GMN20"><path d="M350.7,1071.02 L350.7,1096.1528 A0,0 0 0 0 350.7,1096.1528 L727.6829,1096.1528 A0,0 0 0 0 727.6829,1096.1528 L727.6829,1089.02 L767.23,1083.59 L727.6829,1081.02 L727.6829,1081.02 L717.6829,1071.02 L350.7,1071.02 A0,0 0 0 0 350.7,1071.02" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M717.6829,1071.02 L717.6829,1081.02 L727.6829,1081.02 L717.6829,1071.02" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.9829" x="356.7" y="1088.0869">If no pill was detected (200ms) the LED blinks 5 times.</text></g><!--link *start* to STANDBY--><g class="link" data-entity-1=".start." data-entity-2="STANDBY" data-link-type="dependency" data-source-line="1" data-uid="lnk3" id="link_.start._STANDBY"><path d="M461.2,63.45 C461.2,84.29 461.2,129.82 461.2,169.76" fill="none" id="*start*-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="461.2,175.76,465.2,166.76,461.2,170.76,457.2,166.76,461.2,175.76" style="stroke:#181818;stroke-width:1;"/></g><!--link STANDBY to CHECK_CALIBRATION--><g class="link" data-entity-1="STANDBY" data-entity-2="CHECK_CALIBRATION" data-link-type="dependency" data-source-line="7" data-uid="lnk4" id="link_STANDBY_CHECK_CALIBRATION"><path d="M626.75,255.95 C690.87,269.41 753.79,288.18 774.2,312.31 C785.8,326.02 788.7004,339.5524 788.2104,356.8024" fill="none" id="STANDBY-to-CHECK_CALIBRATION" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="788.04,362.8,792.2939,353.9172,788.182,357.802,784.2972,353.6901,788.04,362.8" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.8872" x="784.2" y="325.3769">eSW0 /</text></g><!--link CHECK_CALIBRATION to STANDBY--><g class="link" data-entity-1="CHECK_CALIBRATION" data-entity-2="STANDBY" data-link-type="dependency" data-source-line="24" data-uid="lnk8" id="link_CHECK_CALIBRATION_STANDBY"><path d="M697.13,365.16 C690.45,362.98 683.75,360.99 677.2,359.31 C624.49,345.8 470.24,370.07 434.2,329.31 C422.8,316.42 421.8667,304.8397 427.5767,288.3497" fill="none" id="CHECK_CALIBRATION-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="429.54,282.68,422.8153,289.8757,427.904,287.4048,430.3749,292.4934,429.54,282.68" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328.3643" x="435.2" y="325.3769">eTick [calibrated = false] / send_msg(CALIB_FAIL);</text></g><!--link *start* to RECALIBRATE--><g class="link" data-entity-1=".start." data-entity-2="RECALIBRATE" data-link-type="dependency" data-source-line="9" data-uid="lnk5" id="link_.start._RECALIBRATE"><path d="M471.54,53.08 C523.95,53.08 756.66,53.08 887.24,53.08" fill="none" id="*start*-to-RECALIBRATE" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="893.24,53.08,884.24,49.08,888.24,53.08,884.24,57.08,893.24,53.08" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381.6846" x="491.91" y="31.1469">[If state loaded from EEPROM on boot was DISPENSE_PILL]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.728" x="602.4544" y="46.2797">/ Recalibrate the spinner.</text></g><!--link RECALIBRATE to STANDBY--><g class="link" data-entity-1="RECALIBRATE" data-entity-2="STANDBY" data-link-type="dependency" data-source-line="14" data-uid="lnk6" id="link_RECALIBRATE_STANDBY"><path d="M893.39,63.83 C819.76,74.14 711.83,93.93 623.2,129.17 C592.87,141.22 566.8342,155.5523 540.0942,172.5423" fill="none" id="RECALIBRATE-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="535.03,175.76,544.7715,174.3096,539.2502,173.0786,540.4812,167.5573,535.03,175.76" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.5229" x="624.2" y="142.2369">eEnter [calibrated = false] / send_msg(RECAL_FAIL);</text></g><!--link RECALIBRATE to DISPENSE_PILL--><g class="link" data-entity-1="RECALIBRATE" data-entity-2="DISPENSE_PILL" data-link-type="dependency" data-source-line="15" data-uid="lnk7" id="link_RECALIBRATE_DISPENSE_PILL"><path d="M986.47,99.42 C991.46,134.49 997.2,184.32 997.2,228.24 C997.2,228.24 997.2,228.24 997.2,739.26 C997.2,783.19 900.9135,831.9144 818.7835,865.9244" fill="none" id="RECALIBRATE-to-DISPENSE_PILL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="813.24,868.22,823.0856,868.4723,817.8596,866.307,820.0249,861.081,813.24,868.22" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42.7388" x="998.2" y="488.0369">eTick /</text></g><!--link CHECK_CALIBRATION to CALIBRATED--><g class="link" data-entity-1="CHECK_CALIBRATION" data-entity-2="CALIBRATED" data-link-type="dependency" data-source-line="25" data-uid="lnk9" id="link_CHECK_CALIBRATION_CALIBRATED"><path d="M777.5,441.67 C776.26,457.3 775.64,475.52 777.2,491.97 C778.11,501.68 778.645,506.1626 780.455,515.8226" fill="none" id="CHECK_CALIBRATION-to-CALIBRATED" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="781.56,521.72,783.8341,512.1373,780.6392,516.8055,775.9709,513.6106,781.56,521.72" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0986" x="778.2" y="488.0369">eTick [calibrated = true] /</text></g><!--link CALIBRATED to DISPENSE_WAIT--><g class="link" data-entity-1="CALIBRATED" data-entity-2="DISPENSE_WAIT" data-link-type="dependency" data-source-line="32" data-uid="lnk10" id="link_CALIBRATED_DISPENSE_WAIT"><path d="M725.68,600.52 C680.55,627.41 625.2342,660.3685 577.6942,688.6985" fill="none" id="CALIBRATED-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="572.54,691.77,582.319,690.5989,576.8352,689.2104,578.2237,683.7266,572.54,691.77" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2412" x="670.2" y="643.2469">eSW0 / send_msg(DISP_START),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.6401" x="702.5667" y="658.3797">write_log(DISP_START)</text></g><!--link DISPENSE_WAIT to DISPENSE_PILL--><g class="link" data-entity-1="DISPENSE_WAIT" data-entity-2="DISPENSE_PILL" data-link-type="dependency" data-source-line="40" data-uid="lnk11" id="link_DISPENSE_WAIT_DISPENSE_PILL"><path d="M554.66,784.72 C585.13,808.41 617.543,833.6174 648.003,857.2974" fill="none" id="DISPENSE_WAIT-to-DISPENSE_PILL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="652.74,860.98,648.0896,852.2982,648.7925,857.9112,643.1795,858.6141,652.74,860.98" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.8682" x="610.2" y="827.4169">eTick [time_reached(TIMEOUT)] /</text></g><!--link DISPENSE_WAIT to STANDBY--><g class="link" data-entity-1="DISPENSE_WAIT" data-entity-2="STANDBY" data-link-type="dependency" data-source-line="41" data-uid="lnk12" id="link_DISPENSE_WAIT_STANDBY"><path d="M372.15,691.73 C332,670.4 291.99,640.57 269.2,600.18 C216.37,506.56 237.05,452.17 291.2,359.31 C309.02,328.74 332.3279,306.4979 360.6579,286.2579" fill="none" id="DISPENSE_WAIT-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="365.54,282.77,355.8916,284.7472,361.4716,285.6766,360.5422,291.2566,365.54,282.77" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.355" x="242.2" y="488.0369">eEnter [turn_count &gt;= 7] / send_msg(EMPTY);</text></g><!--link DISPENSE_PILL to DISPENSE_OK--><g class="link" data-entity-1="DISPENSE_PILL" data-entity-2="DISPENSE_OK" data-link-type="dependency" data-source-line="50" data-uid="lnk13" id="link_DISPENSE_PILL_DISPENSE_OK"><path d="M609.37,946.93 C602.9,949.21 596.47,951.42 590.2,953.52 C476.31,991.62 443.98,989.26 331.2,1030.52 C319.97,1034.63 313.8276,1036.9502 302.3676,1041.7302" fill="none" id="DISPENSE_PILL-to-DISPENSE_OK" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="296.83,1044.04,306.6762,1044.2671,301.4447,1042.1152,303.5966,1036.8836,296.83,1044.04" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.2983" x="487.2" y="996.5869">ePiezo / ++pill_count;</text></g><!--link DISPENSE_PILL to DISPENSE_FAIL--><g class="link" data-entity-1="DISPENSE_PILL" data-entity-2="DISPENSE_FAIL" data-link-type="dependency" data-source-line="51" data-uid="lnk14" id="link_DISPENSE_PILL_DISPENSE_FAIL"><path d="M714.58,953.66 C717.71,969.84 723.52,987.33 734.2,1000.52 C743.49,1012 749.8872,1018.5313 762.1772,1027.2013" fill="none" id="DISPENSE_PILL-to-DISPENSE_FAIL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="767.08,1030.66,762.0316,1022.2034,762.9943,1027.7778,757.42,1028.7405,767.08,1030.66" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0508" x="735.2" y="996.5869">eTick [timer &gt;= 4] /</text></g><!--link DISPENSE_OK to DISPENSE_WAIT--><g class="link" data-entity-1="DISPENSE_OK" data-entity-2="DISPENSE_WAIT" data-link-type="dependency" data-source-line="56" data-uid="lnk15" id="link_DISPENSE_OK_DISPENSE_WAIT"><path d="M210.16,1044.1 C209.64,996.46 215.52,915.04 256.2,861.35 C281.39,828.09 312.8068,805.8297 350.0468,787.4997" fill="none" id="DISPENSE_OK-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="355.43,784.85,345.5887,785.2357,350.944,787.0581,349.1216,792.4134,355.43,784.85" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42.7388" x="257.2" y="911.9969">eTick /</text></g><!--link DISPENSE_FAIL to DISPENSE_WAIT--><g class="link" data-entity-1="DISPENSE_FAIL" data-entity-2="DISPENSE_WAIT" data-link-type="dependency" data-source-line="65" data-uid="lnk16" id="link_DISPENSE_FAIL_DISPENSE_WAIT"><path d="M904.83,1030.11 C904.81,969.08 894.7,869.66 835.2,814.35 C778.04,761.22 738.38,801.26 662.2,784.35 C655.64,782.89 654.7863,782.7321 648.0363,781.1221" fill="none" id="DISPENSE_FAIL-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="642.2,779.73,650.0264,785.7089,647.0636,780.8901,651.8825,777.9272,642.2,779.73" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.5928" x="899.2" y="911.9969">eTick [timer &gt;= 200] /</text></g><!--SRC=[XLRjRk965FtFKzokL0cwX91jjoirIYGsSRKe923mAef8P1by3LFi6SipJfe-Jz-aBzOxCpRui_qLulivvvnxPzO_lS3PsJMitCd3xTUdNluNVWDqkC8KpY55YSgB_UsUSUp7Wo4e5fFb2iQNPN-NRG-mjhOVuTDOExnGV8I1fyHk5s5_S0aT4TTNluwDjqGUUB7SzPtxXVlKMSpvawayjmX3IbmshXulo8QfBz6BnAvirMUz-URSt7atazdqwtBYJkSFDcOCvxtUMkDn3KkdC3jaN4z3aCfN297m0mmWJ4KCZhDOpkz1SDW8eU3Dbt0xNIsSXvNZBQQpsSipfowMkFKZjabrjDeZo8HnZkceLorHGjix1kZ6Ezt8A_8I8PbYWhTu6d3F6_46jyhN4lsd2kjZ4m5X7_gHn0ex9e7t-sGwgrNMsIemb7hfzRWW63x06S6PPbi5zrPLG_X3IEb3mkXCMv5nDGH2JsOSuYnJy1uX8n6I5Z0Wg0qNv8eZxNK6y-WWY8OBibCTFyeEai7dSIn7ndniUg39UcKe5UCG_VFt7jMxX9bO-l2AwK4dCG4viouXZ9nd4fIV-7kLPU0pxiE1sb8ieY2VwQyVWAX_kB27Yp1K8C8Ieezxv8RwWCa4kIHqcTHdI3MuL91fyJ0b8HGf-B39bA8-bO0DGaBJ9wsRpmFOH8mV9Fs4cNCBRtiMeObbV3VgzLg5NIYcegfMJyiITAInmcdQQlAnC_q_wZ7nXNhQKnuLTTkHbGIaa_QgiBVrVYGWHvRGBs2jql9iRAKgctTGMSe9NUFvjaUC31MA2lgIAdA4C8iYusOOKhgOL299TDGpBmLAGVzGgFwo5N520eYH4_bCxGjFWaYI2WHrfEEf7UfcnwaNusNwJKL2zJQe6Q-WL51jjgBU2JN4ZQD6l8djUJrLOx-Mx9KPVvnCtUC2FHNKTezqiNG7GphRMygKNSObGvsxSWUJK9-bu8892q-IYbtgnt10J6I1cHu5ijFMO15acaXBhvuJGGvfJZpXrUYwW2ps3-ZfgqPaogFPZ1DpMNNuhvUEktm2zt5wu_nGKJOTpFs-8hWQaSLqDLDQg6k6xZrgBamlHLgT6FJTwRqp_-uEz2WqCpJtkXQgNR5mVGLVMgxSonejzOPThN1gkPWRQTQs1AGT-guv-NbCARU21_cMqq8sDsPf1Wr38riePRjzQoKpkBI4ym9x_vNYaRuLfSrUxDlfqWUZ3r_CWq4E2d4KYZ6TI12l-kxjDP0jT71yRGoFHVfbDkl-7p-U06rnoqadBvstBOzTgzNl5UxdTzflmV0lOJATxiZB_mhJoxN-AYF2Vp4hivQyE4nrUETtvODRptnNrEEjWcipteXlNHl5qw1TSZbCnmrkgQQjQDaU7basyEJBayoPMUu20bH8pmozs4EmxmlpK3i9YFofT5aI1N8DILpM0ChlhtR8sqXluwJpfTpIK6CdTxdKc6Xjj9kDare-cJTv5pbvKNeSSr62ra1EoFOfEgP1B5Pq_dRvR0Tqz2y0]--></g></svg>