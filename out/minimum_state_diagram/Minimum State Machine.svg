<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="1092px" preserveAspectRatio="none" style="width:1700px;height:1092px;background:#FFFFFF;" version="1.1" viewBox="0 0 1700 1092" width="1700px" zoomAndPan="magnify"><defs/><g><g id="STANDBY"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="330.1484" x="543.88" y="168.67"/><line style="stroke:#181818;stroke-width:0.5;" x1="543.88" x2="874.0284" y1="194.9669" y2="194.9669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.4248" x="675.7418" y="186.6651">STANDBY</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="229.5762" x="548.88" y="211.1055">eEnter / reset_machine(m), timer = 0;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="223.8457" x="548.88" y="225.0743">eTick [timer % 20 = 0] / led_toggle();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="310.1484" x="548.88" y="239.043">eTick [timer&gt;=600] / send_msg(EMPTY), timer = 0;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="548.88" y="253.0118">eExit / led_off();</text></g><g id="RECALIBRATE"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="155.5977" x="1141.15" y="9.73"/><line style="stroke:#181818;stroke-width:0.5;" x1="1141.15" x2="1296.7477" y1="36.0269" y2="36.0269"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1611" x="1170.8683" y="27.7251">RECALIBRATE</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="135.5977" x="1146.15" y="52.1655">eEnter / re_calibrate();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="1146.15" y="66.1343">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="1146.15" y="80.103">eExit /</text></g><g class="entity" data-entity="N1" data-source-line="16" data-uid="ent0004" id="entity_N1"><path d="M1336.76,6 L1336.76,91.6641 L1693.1384,91.6641 L1693.1384,16 L1683.1384,6 L1336.76,6" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1683.1384,6 L1683.1384,16 L1693.1384,16 L1683.1384,6" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.9438" x="1346.8923" y="23.0669">- struct Machine, jossa pill_count,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.7104" x="1346.8923" y="38.1997">sun muut yleiset tiedot stateille.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.3687" x="1346.8923" y="53.3325">- Olkoon 1 tick aluksi 50ms.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.1099" x="1346.8923" y="68.4653">- send_msg() on viestin l&#228;hetys LoRa verkkoon</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.2461" x="1346.8923" y="83.5981">- EEPROM Tallennus tapahtuu aina kun tila vaihtuu</text></g><g id="CHECK_CALIBRATION"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="319.4316" x="392.24" y="341.57"/><line style="stroke:#181818;stroke-width:0.5;" x1="392.24" x2="711.6716" y1="367.8669" y2="367.8669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.4678" x="477.2219" y="359.5651">CHECK_CALIBRATION</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="117.2813" x="397.24" y="384.0055">eEnter / calibrate();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="397.24" y="397.9743">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="299.4316" x="397.24" y="411.943">eExit [calibrated = false] / send_msg(CALIB FAIL);</text></g><g id="CALIBRATED"><rect fill="#F1F1F1" height="78.2031" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="277.332" x="413.29" y="500.5"/><line style="stroke:#181818;stroke-width:0.5;" x1="413.29" x2="690.622" y1="526.7969" y2="526.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.3682" x="507.7719" y="518.4951">CALIBRATED</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="257.332" x="418.29" y="542.9355">eEnter / led_on(); send_msg(CALIBRATED);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="418.29" y="556.9043">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="418.29" y="570.873">eExit / led_off();</text></g><g id="DISPENSE_WAIT"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="291.3887" x="505.26" y="655.7"/><line style="stroke:#181818;stroke-width:0.5;" x1="505.26" x2="796.6487" y1="681.9969" y2="681.9969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112.3896" x="594.7595" y="673.6951">DISPENSE_WAIT</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="194.4258" x="510.26" y="698.1355">eEnter / make_timeout_stamp();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="271.3887" x="510.26" y="712.1043">eEnter [RETRY TWICE!] / send_msg(STATUS);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="39.4512" x="510.26" y="726.073">eTick /</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="510.26" y="740.0418">eExit /</text></g><g id="DISPENSE_PILL"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="203.1055" x="970.4" y="824.88"/><line style="stroke:#181818;stroke-width:0.5;" x1="970.4" x2="1173.5055" y1="851.1769" y2="851.1769"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.46" x="1019.7228" y="842.8751">DISPENSE_PILL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="183.1055" x="975.4" y="867.3155">eEnter / timer = 0, dispense();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="140.1211" x="975.4" y="881.2843">eEnter / ++turn_count;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.4629" x="975.4" y="895.253">eTick / ++timer;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="37.9629" x="975.4" y="909.2218">eExit /</text></g><g id="DISPENSE_FAIL"><rect fill="#F1F1F1" height="92.1719" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="269.2754" x="519.31" y="994.05"/><line style="stroke:#181818;stroke-width:0.5;" x1="519.31" x2="788.5854" y1="1020.3469" y2="1020.3469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.8477" x="601.0239" y="1012.0451">DISPENSE_FAIL</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="249.2754" x="524.31" y="1036.4855">eEnter / timer = 0; send_msg(DISP_FAIL);</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99.4629" x="524.31" y="1050.4543">eTick / ++timer;</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="223.8457" x="524.31" y="1064.423">eTick [timer % 20 = 0] / led_toggle();</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95.3086" x="524.31" y="1078.3918">eExit / led_off();</text></g><ellipse cx="708.95" cy="48.83" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><g class="entity" data-entity="GMN2" data-source-line="17" data-uid="ent0003" id="entity_GMN2"><path d="M253.76,187.05 L253.76,242.4484 A0,0 0 0 0 253.76,242.4484 L504.1516,242.4484 A0,0 0 0 0 504.1516,242.4484 L504.1516,218.75 L543.74,214.75 L504.1516,210.75 L504.1516,197.05 L494.1516,187.05 L253.76,187.05 A0,0 0 0 0 253.76,187.05" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M494.1516,187.05 L494.1516,197.05 L504.1516,197.05 L494.1516,187.05" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.3491" x="259.76" y="204.1169">When the dispenser is started</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.127" x="263.8923" y="219.2497">it waits for a button to be pressed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.4438" x="263.8923" y="234.3825">and blinks an LED while waiting.</text></g><g class="entity" data-entity="GMN5" data-source-line="25" data-uid="ent0006" id="entity_GMN5"><path d="M6,337.84 L6,423.5041 A0,0 0 0 0 6,423.5041 L351.9048,423.5041 A0,0 0 0 0 351.9048,423.5041 L351.9048,384.67 L392.11,380.67 L351.9048,376.67 L351.9048,347.84 L341.9048,337.84 L6,337.84 A0,0 0 0 0 6,337.84" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M341.9048,337.84 L341.9048,347.84 L351.9048,347.84 L341.9048,337.84" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.689" x="12" y="354.9069">When the button is pressed the dispenser</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.0767" x="16.1323" y="370.0397">is calibrated by turning the wheel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0488" x="16.1323" y="385.1725">at least one full turn and then stopping</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.0723" x="16.1323" y="400.3053">the wheel so that the compartment with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.7725" x="16.1323" y="415.4381">the sensor opening is aligned with the drop tube.</text></g><g class="entity" data-entity="GMN8" data-source-line="32" data-uid="ent0009" id="entity_GMN8"><path d="M838.97,519.47 L838.97,535.6 L691.08,539.6 L838.97,543.6 L838.97,559.7356 A0,0 0 0 0 838.97,559.7356 L1160.9378,559.7356 A0,0 0 0 0 1160.9378,559.7356 L1160.9378,529.47 L1150.9378,519.47 L838.97,519.47 A0,0 0 0 0 838.97,519.47" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1150.9378,519.47 L1150.9378,529.47 L1160.9378,529.47 L1150.9378,519.47" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.9019" x="844.97" y="536.5369">After calibration the program keeps</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296.8354" x="849.1023" y="551.6697">the LED on until user presses another button.</text></g><g class="entity" data-entity="GMN11" data-source-line="41" data-uid="ent0012" id="entity_GMN11"><path d="M160.95,681.66 L160.95,721.9256 A0,0 0 0 0 160.95,721.9256 L464.9603,721.9256 A0,0 0 0 0 464.9603,721.9256 L464.9603,705.79 L504.94,701.79 L464.9603,697.79 L464.9603,691.66 L454.9603,681.66 L160.95,681.66 A0,0 0 0 0 160.95,681.66" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M454.9603,681.66 L454.9603,691.66 L464.9603,691.66 L454.9603,681.66" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.9136" x="166.95" y="698.7269">Then it dispenses pills every</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.8779" x="171.0823" y="713.8597">30 seconds starting from the button press.</text></g><g class="entity" data-entity="GMN14" data-source-line="42" data-uid="ent0015" id="entity_GMN14"><path d="M836.6,674.09 L836.6,697.79 L797.06,701.79 L836.6,705.79 L836.6,729.4884 A0,0 0 0 0 836.6,729.4884 L1091.308,729.4884 A0,0 0 0 0 1091.308,729.4884 L1091.308,684.09 L1081.308,674.09 L836.6,674.09 A0,0 0 0 0 836.6,674.09" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1081.308,674.09 L1081.308,684.09 L1091.308,684.09 L1081.308,674.09" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.5757" x="842.6" y="691.1569">When all pills have been dispensed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.605" x="846.7323" y="706.2897">(wheel turned 7 times)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.6816" x="846.7323" y="721.4225">the program starts over.</text></g><g class="entity" data-entity="GMN17" data-source-line="51" data-uid="ent0018" id="entity_GMN17"><path d="M681.25,843.26 L681.25,898.6584 A0,0 0 0 0 681.25,898.6584 L930.6514,898.6584 A0,0 0 0 0 930.6514,898.6584 L930.6514,874.96 L970.02,870.96 L930.6514,866.96 L930.6514,853.26 L920.6514,843.26 L681.25,843.26 A0,0 0 0 0 681.25,843.26" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M920.6514,843.26 L920.6514,853.26 L930.6514,853.26 L920.6514,843.26" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3613" x="687.25" y="860.3269">When the wheel is turned,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.1367" x="691.3823" y="875.4597">the piezo sensor is used to detect</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.2773" x="691.3823" y="890.5925">if a pill was dispensed or not.</text></g><g class="entity" data-entity="GMN20" data-source-line="59" data-uid="ent0021" id="entity_GMN20"><path d="M102.46,1027.57 L102.46,1052.7028 A0,0 0 0 0 102.46,1052.7028 L479.4429,1052.7028 A0,0 0 0 0 479.4429,1052.7028 L479.4429,1045.57 L518.99,1040.13 L479.4429,1037.57 L479.4429,1037.57 L469.4429,1027.57 L102.46,1027.57 A0,0 0 0 0 102.46,1027.57" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M469.4429,1027.57 L469.4429,1037.57 L479.4429,1037.57 L469.4429,1027.57" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355.9829" x="108.46" y="1044.6369">If no pill was detected (200ms) the LED blinks 5 times.</text></g><!--link *start* to STANDBY--><g class="link" data-entity-1=".start." data-entity-2="STANDBY" data-source-line="1" data-uid="lnk3" id="link_.start._STANDBY"><path d="M708.95,59.12 C708.95,79.77 708.95,124.69 708.95,162.49" fill="none" id="*start*-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="708.95,168.49,712.95,159.49,708.95,163.49,704.95,159.49,708.95,168.49" style="stroke:#181818;stroke-width:1;"/></g><!--link STANDBY to CHECK_CALIBRATION--><g class="link" data-entity-1="STANDBY" data-entity-2="CHECK_CALIBRATION" data-source-line="6" data-uid="lnk4" id="link_STANDBY_CHECK_CALIBRATION"><path d="M690.89,261.28 C683.2,277.14 673.15,294.32 660.95,307.84 C649.71,320.29 640.8025,328.1238 626.7825,337.8338" fill="none" id="STANDBY-to-CHECK_CALIBRATION" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="621.85,341.25,631.5262,339.4141,625.9604,338.4032,626.9713,332.8374,621.85,341.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="45.8872" x="674.95" y="303.9069">eSW0 /</text></g><!--link CHECK_CALIBRATION to STANDBY--><g class="link" data-entity-1="CHECK_CALIBRATION" data-entity-2="STANDBY" data-source-line="22" data-uid="lnk8" id="link_CHECK_CALIBRATION_STANDBY"><path d="M491.44,341.3 C474.86,326 464.49,307.98 476.95,290.84 C486.76,277.36 506.8018,267.0086 537.7318,256.4486" fill="none" id="CHECK_CALIBRATION-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="543.41,254.51,533.6003,253.6325,538.6782,256.1255,536.1851,261.2034,543.41,254.51" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.3452" x="477.95" y="303.9069">eTick [calibrated = false] /</text></g><!--link *start* to RECALIBRATE--><g class="link" data-entity-1=".start." data-entity-2="RECALIBRATE" data-source-line="8" data-uid="lnk5" id="link_.start._RECALIBRATE"><path d="M719.14,48.83 C771.61,48.83 1007.81,48.83 1134.78,48.83" fill="none" id="*start*-to-RECALIBRATE" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1140.78,48.83,1131.78,44.83,1135.78,48.83,1131.78,52.83,1140.78,48.83" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381.6846" x="739.55" y="26.8969">[If state loaded from EEPROM on boot was DISPENSE_PILL]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.728" x="850.0944" y="42.0297">/ Recalibrate the spinner.</text></g><!--link RECALIBRATE to STANDBY--><g class="link" data-entity-1="RECALIBRATE" data-entity-2="STANDBY" data-source-line="12" data-uid="lnk6" id="link_RECALIBRATE_STANDBY"><path d="M1140.86,56.23 C1064.42,64.51 945.81,82.78 849.95,121.67 C821.1,133.37 796.7753,147.8434 772.4553,164.7634" fill="none" id="RECALIBRATE-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="767.53,168.19,777.2023,166.3336,771.6344,165.3345,772.6335,159.7666,767.53,168.19" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.1553" x="850.95" y="134.7369">eEnter [calibrated = false] / send_msg(RECAL FAIL);</text></g><!--link RECALIBRATE to DISPENSE_PILL--><g class="link" data-entity-1="RECALIBRATE" data-entity-2="DISPENSE_PILL" data-source-line="13" data-uid="lnk7" id="link_RECALIBRATE_DISPENSE_PILL"><path d="M1220.05,88.25 C1220.91,121.47 1221.95,170.77 1221.95,213.75 C1221.95,213.75 1221.95,213.75 1221.95,702.79 C1221.95,745.7 1219.27,760.99 1192.95,794.88 C1184.31,806.01 1178.322,812.3027 1166.762,820.9627" fill="none" id="RECALIBRATE-to-DISPENSE_PILL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1161.96,824.56,1171.5612,822.3653,1165.9617,821.5622,1166.7648,815.9627,1161.96,824.56" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.0669" x="1222.95" y="466.5669">eTick / recall_position();</text></g><!--link CHECK_CALIBRATION to CALIBRATED--><g class="link" data-entity-1="CHECK_CALIBRATION" data-entity-2="CALIBRATED" data-source-line="23" data-uid="lnk9" id="link_CHECK_CALIBRATION_CALIBRATED"><path d="M551.95,420.06 C551.95,444.38 551.95,469.72 551.95,494.06" fill="none" id="CHECK_CALIBRATION-to-CALIBRATED" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="551.95,500.06,555.95,491.06,551.95,495.06,547.95,491.06,551.95,500.06" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0986" x="552.95" y="466.5669">eTick [calibrated = true] /</text></g><!--link CALIBRATED to DISPENSE_WAIT--><g class="link" data-entity-1="CALIBRATED" data-entity-2="DISPENSE_WAIT" data-source-line="30" data-uid="lnk10" id="link_CALIBRATED_DISPENSE_WAIT"><path d="M537.64,578.78 C534.22,594.11 533.44,611.48 540.95,625.7 C546.89,636.95 550.8802,642.8386 560.5102,651.4186" fill="none" id="CALIBRATED-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="564.99,655.41,560.9312,646.4364,561.2568,652.0839,555.6093,652.4095,564.99,655.41" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.1089" x="541.95" y="621.7669">eSW1 / send_msg(DISP_START)</text></g><!--link DISPENSE_WAIT to DISPENSE_PILL--><g class="link" data-entity-1="DISPENSE_WAIT" data-entity-2="DISPENSE_PILL" data-source-line="38" data-uid="lnk11" id="link_DISPENSE_WAIT_DISPENSE_PILL"><path d="M797.11,742.64 C803.81,744.42 810.45,746.17 816.95,747.88 C869.72,761.69 886.17,755.58 935.95,777.88 C963.28,790.11 986.1875,804.3128 1009.4575,820.9328" fill="none" id="DISPENSE_WAIT-to-DISPENSE_PILL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1014.34,824.42,1009.341,815.9341,1010.2712,821.514,1004.6914,822.4442,1014.34,824.42" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.8682" x="967.95" y="790.9469">eTick [time_reached(TIMEOUT)] /</text></g><!--link DISPENSE_PILL to DISPENSE_WAIT--><g class="link" data-entity-1="DISPENSE_PILL" data-entity-2="DISPENSE_WAIT" data-source-line="48" data-uid="lnk13" id="link_DISPENSE_PILL_DISPENSE_WAIT"><path d="M970.2,829.93 C963.74,828.05 957.29,826.34 950.95,824.88 C883.73,809.37 688.32,845.96 641.95,794.88 C630.62,782.39 628.9085,770.5325 632.2385,753.9525" fill="none" id="DISPENSE_PILL-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="633.42,748.07,627.7261,756.1061,632.4354,752.9721,635.5695,757.6814,633.42,748.07" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282.5977" x="642.95" y="790.9469">ePiezo / ++pill_count; send_msg(DISP_OK);</text></g><!--link DISPENSE_WAIT to STANDBY--><g class="link" data-entity-1="DISPENSE_WAIT" data-entity-2="STANDBY" data-source-line="39" data-uid="lnk12" id="link_DISPENSE_WAIT_STANDBY"><path d="M729.78,655.49 C739.1,646.82 747.3,636.89 752.95,625.7 C813.83,505.29 763.4562,345.4997 731.4662,266.6697" fill="none" id="DISPENSE_WAIT-to-STANDBY" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="729.21,261.11,728.8878,270.9536,731.0901,265.743,736.3007,267.9454,729.21,261.11" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.355" x="780.95" y="466.5669">eEnter [turn_count &gt;= 7] / send_msg(EMPTY);</text></g><!--link DISPENSE_PILL to DISPENSE_FAIL--><g class="link" data-entity-1="DISPENSE_PILL" data-entity-2="DISPENSE_FAIL" data-source-line="49" data-uid="lnk14" id="link_DISPENSE_PILL_DISPENSE_FAIL"><path d="M969.97,912.75 C908.82,937.2 836.511,966.1221 773.371,991.3721" fill="none" id="DISPENSE_PILL-to-DISPENSE_FAIL" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="767.8,993.6,777.6418,993.9722,772.4425,991.7434,774.6713,986.5441,767.8,993.6" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0508" x="875.95" y="960.1169">eTick [timer &gt;= 4] /</text></g><!--link DISPENSE_FAIL to DISPENSE_WAIT--><g class="link" data-entity-1="DISPENSE_FAIL" data-entity-2="DISPENSE_WAIT" data-source-line="57" data-uid="lnk15" id="link_DISPENSE_FAIL_DISPENSE_WAIT"><path d="M579.03,993.81 C553.09,973.82 527.01,947.83 512.95,917.05 C495.93,879.79 496.13,862.23 512.95,824.88 C526.75,794.25 547.7236,771.9188 573.2336,751.8588" fill="none" id="DISPENSE_FAIL-to-DISPENSE_WAIT" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="577.95,748.15,568.4028,750.5689,574.0196,751.2407,573.3479,756.8575,577.95,748.15" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.5928" x="513.95" y="875.5269">eTick [timer &gt;= 200] /</text></g><!--SRC=[XLRRRkCs47ttLqmNA61t7SVPThj0WmJm9Yfgh9COjXP1u0G2ROqirX8fY5JIz7lw9_sn3gcBTJFw54TpF-TmoCrFBt1sTWrhTtP_-_LfKFo5tm0TeJ65SqXHeVPYjWkvm64y6eFcCLckO7fPztVvxW2RtFOZV9eQXnUAZz3tjDpl8noEBk54nFNLhrFhhL3uNgpsG-TkwJwTBERynNMHMmO19QwCPfgRFvoRRzxDR37_kfgvyuTx4x9-dCBvOB0n4r_3oYdD3Xatym2KPXeXain77u9Knk0uozN37KW1Moarl345j_FrqhbVEzvolbYyF0lgOOKx5l5jQg9rYA0IBWIcaq6pH0rFhmemZRVSB2ZddM0xR-DhZRPZ-asLsYVC0XOfRA1g4y3li_cYLTbaQmntx8KwfgoHbqZ5DPV2D3qO24dpVe0pmYtDTXhkSe6CuK-f58E4KyHEPaAFWM1IcO0uopIyHyX9JqGh-eIf1PrSSMAypk0XEaZ2-uBiL9f5sK5n-3oDrSIQgpb6XfLNZafp0T6__uIetnKiv8h1AwO7ayG651Iwr3yAaIdGB66XpZ9WN30uK5kQHnJ4kFdw0OZZ-ujyk0W33JAeWVmOeh0S-rmbA1G1pfMP8JLuKq5kLCArWa2cm62RQKrzQWbRX8GEaihTcF1X6t5nKFGJ5iujl8KyGXlBnNuo6FGgk5HGGpwzdWLn9z8OBVsVK6nCAPHkcfRuyfFSc_94SAMysnFnf2eRtkIYRw2AbG9kegJ4kidLixNLgcpVGMUf8CYjvrk865b-D1LaYYeAX22B8kjcQTEccD8oIKpKiwW5Aad_KAZvifDnGgg8KP0Yk0vBJy9NaJGaTMJYgHtgPY-e5-jb-qrbGlMsQ6JGGAdatsuzSmnRT5b7GrSNs_Dsgix-hDaRk-1nDdVpzNbHruUnUwI0bJjgKrGlD0jCooNaNEOe9AdSfoo60sAYIcZCCI0xRGmUGMRuobaqPqIIGrhmIx1qcYkHYTa1FNDZo4nxT2xZnDuv9_mtAyTTFO7xEBznVcYedmPplwy9bKvaURAwAND4MuRJQzNUUrwAj3RH7xhpE-VXkpioYkzcwAvveyTylSBr5NpfkJalMxIq6tQDaAdbydWekx8L8EtFTyF9prDAkPF2BpQSqQkz5cj7pJ8qoGkbV1_sLhBdanPmKI1ahnIFzAqiRNVYC3z4PZ3wyCNU-sfKYgDKZEr4WNmr5-oWWsofW-hHCAwA3Ejijlq_VZm2skDMa4vU9czVdlnwRdxlFKPBZdzBc-juGrwsZjN3jqwlZLncAxTVNAI2NxhhijrejIfpi6dzv7YFAvnjUyMM8dDcjwW47pNI9MysQ03vxMxVGqSAoPzArqafs-oGqfwtk6Nwv-k3lG-0aq_EdeOwow_fqajS2-nFzhbw2kwY4hqgXQo1PK4ah8OK7PEuoxLNl0K-vwAV_0S0]--></g></svg>